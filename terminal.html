<!DOCTYPE html>
<html>
	<head>
		<meta charset='utf-8'>
		<title>JS-Term</title>
		<link rel="shortcut icon" href="/favicon.ico">
		<style>
			 body {
				overflow-y: scroll;
				padding: 0;
				margin: 0;
			}
			#terminal div{				
				white-space: pre;
				overflow: hidden;
				font-family: Menlo, monospace;
				font-size:11px;
				height: 14px;
			}
			#beep {
				position:absolute;
				top:0px;
			}
		</style>
		<script src='jquery-1.5.min.js'></script>
		<script src='socket.io.js'></script>
		<script src='termemul.js'></script>
		<script>
			$(function() {
				TermJS.theme(TermJS.themes['Terminal.app']);
				TermJS.output('Welcome to the rabbit holeâ€¦\r\n\r\n');

				socket = new io.Socket();
				socket.connect();

				socket.on('connect', function(){					
					socket.send(location.pathname);
					TermJS.setStdin(function(data){socket.send(data);});
				});
				
				socket.on('message', function(data){
				    TermJS.output(data);
				});
				
				socket.on('disconnect',function() {
					TermJS.setStdin($.noop);
					TermJS.output('\r\n\n\u001B[0;1mCONNECTION CLOSED. \u001B[0m');
				});
		

			/*
				// Simple echo terminal
				TermJS.output('\r\n> ');
				TermJS.setStdin( function(data) {
					TermJS.output(data.replace('\r', '\r\n> ').replace('\b', '\b \b'));
				});
			*/

			});
		</script>
	</head>
	<body>
		<div id='terminal' class='a0088'></div>
		<object id="beep" type="application/x-shockwave-flash" data="flashbeep-general.swf" width="1" height="1">
			<param name="movie" value="flashbeep-general.swf" />
			<param name="FlashVars" value="onLoad=isReady" />
		</object>
	</body>
</html>
